<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PROSTOVANII CASINO - VEGAS</title>
    <style>
        body {
            background: #050505;
            color: white;
            text-align: center;
            font-family: 'Arial Black', sans-serif;
            margin: 0;
            padding: 0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        /* --- SEMN LAS VEGAS --- */
        .vegas-sign {
            position: relative;
            display: inline-block;
            margin: 10px auto;
            padding: 10px 30px;
            background: #d00000;
            border: 4px solid #fff;
            border-radius: 100px / 50px;
            box-shadow: 0 0 20px #f00, inset 0 0 15px #000;
            z-index: 10;
        }

        .vegas-sign::before {
            content: "";
            position: absolute;
            top: -8px; left: -8px; right: -8px; bottom: -8px;
            border: 3px dotted #ffd700;
            border-radius: 110px / 55px;
            animation: blink-lights 0.4s infinite;
        }

        @keyframes blink-lights {
            0% { opacity: 1; } 50% { opacity: 0.2; } 100% { opacity: 1; }
        }

        .main-title {
            font-size: clamp(22px, 7vw, 45px);
            margin: 0;
            color: white;
            text-transform: uppercase;
            line-height: 1.1;
            text-shadow: 2px 2px 0 #000;
        }

        .machine {
            background: linear-gradient(180deg, #300 0%, #100 100%);
            padding: 15px;
            border-radius: 20px;
            display: inline-block;
            border: 4px solid #b8860b;
            box-shadow: 0 0 30px rgba(255, 0, 0, 0.6);
            margin-top: 5px;
            max-width: 95%;
        }

        .reels-container {
            display: flex;
            gap: 8px;
            background: #000;
            padding: 8px;
            border-radius: 12px;
            border: 2px solid #444;
            justify-content: center;
        }

        .reel {
            width: clamp(75px, 25vw, 140px);
            height: clamp(120px, 35vh, 200px);
            position: relative; 
            overflow: hidden; 
            background: #111;
        }

        .reel-strip {
            position: absolute; top: 0; left: 0; width: 100%;
            display: flex; flex-direction: column;
        }

        .reel-strip img { 
            width: 100%; 
            height: clamp(120px, 35vh, 200px); 
            object-fit: cover; 
        }

        .controls {
            margin-top: 15px;
            width: 100%;
        }

        .bet-row {
            display: flex;
            justify-content: center;
            gap: 6px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        .balance-info {
            font-size: clamp(16px, 5vw, 24px);
            color: #0f0;
            text-shadow: 0 0 10px rgba(0,255,0,0.3);
            font-weight: bold;
            margin-bottom: 5px;
        }

        .bet-btn {
            background: #200; 
            color: white; 
            border: 2px solid #f00;
            padding: 8px 12px; 
            cursor: pointer; 
            border-radius: 8px;
            font-weight: bold; 
            font-size: 13px;
            transition: 0.2s;
        }
        .bet-btn.active { 
            background: #ffd700; 
            color: black; 
            border-color: #fff; 
            box-shadow: 0 0 10px #ffd700;
        }

        .spin-btn {
            font-size: clamp(22px, 6vw, 32px); 
            padding: 12px 50px; 
            cursor: pointer; 
            border-radius: 50px;
            border: none; 
            background: linear-gradient(#f00, #800);
            color: white; 
            font-weight: 900;
            box-shadow: 0 4px 0 #400;
            text-transform: uppercase;
        }
        .spin-btn:active { transform: translateY(2px); box-shadow: 0 2px 0 #400; }
        .spin-btn:disabled { opacity: 0.5; filter: grayscale(1); cursor: not-allowed; }

        #result { 
            font-size: clamp(18px, 6vw, 35px); 
            margin-top: 10px; 
            min-height: 40px; 
            font-weight: 900; 
        }
        
        .win-shake {
            color: #ffd700;
            text-shadow: 0 0 20px #f00, 0 0 40px #ffd700;
            animation: shake 0.2s infinite;
        }
        @keyframes shake {
            0% { transform: scale(1.1) rotate(1deg); }
            100% { transform: scale(1.1) rotate(-1deg); }
        }

        #canvas { position: fixed; top: 0; left: 0; pointer-events: none; z-index: 1000; }
    </style>
</head>
<body>

<canvas id="canvas"></canvas>
<audio id="audio-win" src="win.wav" preload="auto"></audio>
<audio id="audio-spin" src="spin.mp3" preload="auto"></audio>

<div class="vegas-sign">
    <div style="color: #ffd700; font-size: 11px; letter-spacing: 2px;">✦ WELCOME ✦</div>
    <h1 class="main-title">PROSTOVANII<br>CASINO</h1>
</div>

<div class="machine">
    <div class="reels-container">
        <div class="reel"><div id="strip1" class="reel-strip"></div></div>
        <div class="reel"><div id="strip2" class="reel-strip"></div></div>
        <div class="reel"><div id="strip3" class="reel-strip"></div></div>
    </div>

    <div class="controls">
        <div class="bet-row">
            <button class="bet-btn active" onclick="setBet(50, this)">50 RON</button>
            <button class="bet-btn" onclick="setBet(100, this)">100 RON</button>
            <button class="bet-btn" onclick="setBet(250, this)">250 RON</button>
            <button class="bet-btn" onclick="setBet(500, this)">500 RON</button>
        </div>
        <div class="balance-info">BALANȚĂ: <span id="balance-val">10000</span> RON</div>
    </div>

    <button id="spin-btn" class="spin-btn" onclick="spin()">SPIN!</button>
    <div id="result"></div>
</div>

<script>
    let wallet = 10000;
    let currentBet = 50;
    let isSpinning = false;
    let audioUnlocked = false;

    const symbols = ["Image (2).jpg", "Image (3).jpg", "Image (4).jpg", "wild.jpg"];
    const itemsCount = 40;

    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    let moneyParticles = [];
    const sndWin = document.getElementById('audio-win');
    const sndSpin = document.getElementById('audio-spin');

    function getImgHeight() {
        return document.querySelector('.reel').offsetHeight;
    }

    function init() {
        const imgH = getImgHeight();
        document.querySelectorAll('.reel-strip').forEach(s => {
            s.innerHTML = '';
            for(let i=0; i<itemsCount; i++){
                let img = document.createElement('img');
                img.src = symbols[Math.floor(Math.random()*symbols.length)];
                s.appendChild(img);
            }
            s.style.transition = "none";
            s.style.top = `-${(itemsCount-1)*imgH}px`;
        });
    }

    function setBet(v, b) {
        if(isSpinning) return;
        currentBet = v;
        document.querySelectorAll('.bet-btn').forEach(x => x.classList.remove('active'));
        b.classList.add('active');
    }

    function spin() {
        if(isSpinning) return;
        if(wallet < currentBet) return alert("N-ai bani, prostovane!");

        // DEBLOCARE AUDIO (PENTRU BROWSER)
        if(!audioUnlocked) {
            [sndWin, sndSpin].forEach(track => {
                track.play().then(() => {
                    track.pause();
                    track.currentTime = 0;
                }).catch(e => console.log("Audio waiting..."));
            });
            audioUnlocked = true;
        }
        
        isSpinning = true;
        wallet -= currentBet;
        document.getElementById('balance-val').innerText = wallet;
        
        // REDARE SUNET SPIN
        sndSpin.currentTime = 0;
        sndSpin.play().catch(e => console.log("Eroare sunet spin"));

        const btn = document.getElementById('spin-btn');
        const res = document.getElementById('result');
        const imgH = getImgHeight();
        
        btn.disabled = true;
        res.innerText = "NOROC...";
        res.style.color = "gray";
        res.classList.remove('win-shake');

        let results = [];
        for(let i=1; i<=3; i++) {
            let s = document.getElementById('strip'+i);
            let idx = Math.floor(Math.random()*symbols.length);
            results.push(s.children[idx].src);
            
            s.style.transition = "none";
            s.style.top = `-${(itemsCount-1)*imgH}px`;
            s.offsetHeight; 

            s.style.transition = `top ${1.5+i*0.5}s cubic-bezier(0.1, 0, 0.1, 1)`;
            s.style.top = `-${idx*imgH}px`;
        }

        setTimeout(() => {
            // OPRIM SUNETUL DE SPIN ÎNAINTE DE REZULTAT
            sndSpin.pause();
            sndSpin.currentTime = 0;
            
            checkWin(results);
            btn.disabled = false;
            isSpinning = false;
        }, 3200);
    }

    function checkWin(paths) {
        const res = document.getElementById('result');
        const s = paths.map(p => decodeURIComponent(p.split('/').pop()));
        let nonW = s.filter(x => x !== "wild.jpg");
        let dom = nonW.length > 0 ? nonW[0] : "wild.jpg";
        let win = s.every(x => x === dom || x === "wild.jpg");

        if(win) {
            sndWin.currentTime = 0;
            sndWin.play().catch(e => console.log("Eroare sunet win"));
            
            setTimeout(() => {
                sndWin.pause();
                sndWin.currentTime = 0;
            }, 4000);

            let mult = dom.includes("(4)") || dom === "wild.jpg" ? 100 : dom.includes("(3)") ? 20 : 10;
            wallet += currentBet * mult;
            document.getElementById('balance-val').innerText = wallet;
            res.innerText = "L-AI RUPT BAAAAA!";
            res.style.color = "#ffd700";
            res.classList.add('win-shake');
            rainMoney();
        } else {
            res.innerText = "MAI BAGĂ O FISĂ!";
            res.style.color = "white";
        }
    }

    function rainMoney() {
        for(let i=0; i<100; i++) {
            moneyParticles.push({
                x: Math.random() * canvas.width,
                y: -50,
                w: 50, h: 25,
                speedY: 4 + Math.random() * 6,
                rot: Math.random() * 360,
                rotSpeed: (Math.random() - 0.5) * 15
            });
        }
    }

    function draw() {
        ctx.clearRect(0,0,canvas.width,canvas.height);
        moneyParticles.forEach((p, i) => {
            p.y += p.speedY; p.rot += p.rotSpeed;
            ctx.save();
            ctx.translate(p.x, p.y);
            ctx.rotate(p.rot * Math.PI / 180);
            ctx.fillStyle = "#2e7d32";
            ctx.fillRect(-p.w/2, -p.h/2, p.w, p.h);
            ctx.strokeStyle = "#fff";
            ctx.strokeRect(-p.w/2, -p.h/2, p.w, p.h);
            ctx.restore();
            if(p.y > canvas.height + 50) moneyParticles.splice(i, 1);
        });
        requestAnimationFrame(draw);
    }

    window.onload = () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        init(); draw();
    };

    window.onresize = () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        init();
    }
</script>

</body>
</html>
